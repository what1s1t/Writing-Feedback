<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ë°˜ ì˜ì–´ ì—ì„¸ì´ AI ì„ ìƒë‹˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; background-color: #f0f4f8; }
        .prose del { color: #ef4444; text-decoration: line-through; background: #fee2e2; padding: 0 2px; }
        .prose ins { color: #2563eb; text-decoration: none; font-weight: 700; background: #dbeafe; padding: 0 4px; border-radius: 4px; }
        .loading-spinner { border: 3px solid #f3f3f3; border-top: 3px solid #4f46e5; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen p-4 md:p-10">
    <div class="max-w-3xl mx-auto">
        <div class="bg-white rounded-3xl shadow-2xl overflow-hidden">
            <!-- í—¤ë” -->
            <div class="bg-indigo-600 p-8 text-white text-center">
                <h1 class="text-3xl font-bold mb-2">âœï¸ ì˜ì–´ ì—ì„¸ì´ AI ì²¨ì‚­ì†Œ</h1>
                <p class="opacity-90">ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ ë¬¸ë²•ë¶€í„° ë…¼ë¦¬ êµ¬ì¡°ê¹Œì§€ í•œ ë²ˆì— ê³ ì³ë“œë ¤ìš”.</p>
            </div>

            <div class="p-8">
                <!-- ì—…ë¡œë“œ ì„¹ì…˜ -->
                <div id="dropZone" class="border-3 border-dashed border-indigo-100 rounded-2xl p-12 text-center hover:bg-indigo-50 hover:border-indigo-300 transition-all cursor-pointer group mb-6">
                    <input type="file" id="fileInput" accept="image/*" class="hidden">
                    <div id="uploadPrompt">
                        <div class="text-6xl mb-4 group-hover:scale-110 transition-transform">ğŸ“„</div>
                        <p class="text-xl font-semibold text-slate-700">ì—ì„¸ì´ ì‚¬ì§„ ì—…ë¡œë“œ</p>
                        <p class="text-slate-400 mt-2">í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ì—¬ê¸°ë¡œ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”</p>
                    </div>
                    <div id="previewArea" class="hidden">
                        <img id="imagePreview" src="" class="max-h-80 mx-auto rounded-xl shadow-lg mb-4">
                        <button id="cancelBtn" class="text-red-500 font-medium hover:text-red-700">ë‹¤ì‹œ ì„ íƒí•˜ê¸°</button>
                    </div>
                </div>

                <!-- ì‹¤í–‰ ë²„íŠ¼ -->
                <button id="analyzeBtn" class="w-full py-5 bg-indigo-600 text-white rounded-2xl font-bold text-xl hover:bg-indigo-700 disabled:bg-slate-200 disabled:cursor-not-allowed transition-all shadow-lg" disabled>
                    ì²¨ì‚­ ì‹œì‘í•˜ê¸°
                </button>

                <!-- ê²°ê³¼ ëŒ€ê¸° ìƒíƒœ -->
                <div id="statusArea" class="hidden mt-8 text-center p-6 bg-slate-50 rounded-2xl">
                    <div class="flex items-center justify-center gap-3 mb-2">
                        <div class="loading-spinner"></div>
                        <span class="text-indigo-600 font-bold">AI ì„ ìƒë‹˜ì´ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</span>
                    </div>
                    <p class="text-slate-500 text-sm">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš” (ì•½ 10~20ì´ˆ ì†Œìš”)</p>
                </div>

                <!-- ê²°ê³¼ì°½ -->
                <div id="resultArea" class="hidden mt-10 animate-in fade-in slide-in-from-bottom-4 duration-500">
                    <div class="flex items-center justify-between mb-4 border-b pb-4">
                        <h2 class="text-2xl font-bold text-slate-800">âœ¨ ì²¨ì‚­ ê²°ê³¼ì§€</h2>
                        <button onclick="window.print()" class="text-indigo-600 font-semibold hover:underline">PDF ì €ì¥/ì¸ì‡„</button>
                    </div>
                    <div id="formattedResult" class="prose max-w-none text-slate-700 leading-relaxed space-y-4">
                        <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— ë Œë”ë§ë¨ -->
                    </div>
                </div>
            </div>
        </div>
        <p class="text-center text-slate-400 mt-6 text-sm">Powered by Gemini AI Engine</p>
    </div>

    <script>
        // --- ì„¤ì •: ì„ ìƒë‹˜ì˜ API í‚¤ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš” ---
        const apiKey = "AIzaSyD26uKyQvV5plrPBBhlSRPi3pmmqZQ5upM";
        // ------------------------------------------

        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultArea = document.getElementById('resultArea');
        const formattedResult = document.getElementById('formattedResult');
        const statusArea = document.getElementById('statusArea');
        const previewArea = document.getElementById('previewArea');
        const uploadPrompt = document.getElementById('uploadPrompt');
        const imagePreview = document.getElementById('imagePreview');

        let base64Image = "";

        dropZone.onclick = () => fileInput.click();

        fileInput.onchange = (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (ev) => {
                base64Image = ev.target.result.split(',')[1];
                imagePreview.src = ev.target.result;
                uploadPrompt.classList.add('hidden');
                previewArea.classList.remove('hidden');
                analyzeBtn.disabled = false;
            };
            reader.readAsDataURL(file);
        };

        document.getElementById('cancelBtn').onclick = (e) => {
            e.stopPropagation();
            fileInput.value = "";
            base64Image = "";
            uploadPrompt.classList.remove('hidden');
            previewArea.classList.add('hidden');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');
        };

        async function analyze() {
            if (!apiKey) {
                alert("API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì½”ë“œ ë‚´ë¶€ì—ì„œ í‚¤ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
                return;
            }

            statusArea.classList.remove('hidden');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');

            const systemInstruction = `ë„ˆëŠ” ì´ˆì¤‘ë“± ì˜ì–´ ê¸€ì“°ê¸° íŠœí„°ì•¼. í•™ìƒì˜ ì—ì„¸ì´ ì‚¬ì§„ì„ ì²¨ì‚­í•´ì¤˜.
            1. ìˆ˜ì¤€: í•™ìƒ ìˆ˜ì¤€ì— ë§ì¶˜ ì‰¬ìš´ ë‹¨ì–´ ì‚¬ìš©.
            2. ì„œë¡ : ë³¸ë¡  ë¬¸ë‹¨ ê°œìˆ˜ì™€ ì„œë¡ ì˜ ì´ìœ  ê°œìˆ˜ê°€ ë§ëŠ”ì§€ í™•ì¸.
            3. ë³¸ë¡ : [ì£¼ì œ-ê·¼ê±°-ê²½í—˜] êµ¬ì¡° í™•ì¸ ë° ë¶€ì¡±í•œ ë¶€ë¶„ ë³´ì¶©.
            4. ê²°ë¡ : ì„¤ë“ë ¥ ìˆê²Œ ìˆ˜ì •.
            5. í‘œì‹œ: í‹€ë¦°ê±´ <del>ì·¨ì†Œì„ </del>, ìˆ˜ì •ë³¸ì€ <ins>ê°•ì¡°</ins> í‘œì‹œ.
            6. ì„¤ëª…: ë¬¸ë‹¨ë³„ë¡œ 'ì™œ ì´ë ‡ê²Œ ê³ ì³¤ë‚˜ìš”?'ë¥¼ í•œêµ­ì–´ë¡œ ì•„ì£¼ ì¹œì ˆí•˜ê²Œ ì„¤ëª….`;

            const payload = {
                contents: [{
                    parts: [
                        { text: "ì´ ì—ì„¸ì´ ì‚¬ì§„ì„ ë¶„ì„í•´ì„œ HTML í˜•ì‹ìœ¼ë¡œ ì²¨ì‚­í•´ì¤˜." },
                        { inlineData: { mimeType: "image/png", data: base64Image } }
                    ]
                }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const output = data.candidates[0].content.parts[0].text;
                // ë§ˆí¬ë‹¤ìš´ ë°±í‹± ì œê±°
                formattedResult.innerHTML = output.replace(/```html|```/g, '').trim();
                resultArea.classList.remove('hidden');
            } catch (err) {
                alert("ì˜¤ë¥˜ ë°œìƒ: " + err.message);
            } finally {
                statusArea.classList.add('hidden');
                analyzeBtn.disabled = false;
            }
        }

        analyzeBtn.onclick = analyze;
    </script>
</body>
</html>

