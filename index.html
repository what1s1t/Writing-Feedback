<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; }
        .loading { display: none; }
        .loading.active { display: flex; }
        del { color: #ef4444; text-decoration: line-through; background: #fee2e2; padding: 0 2px; }
        ins { color: #2563eb; text-decoration: none; font-weight: 700; background: #dbeafe; padding: 0 4px; border-radius: 4px; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl font-bold text-indigo-600 mb-2">âœï¸ ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­</h1>
            <p class="text-slate-600 font-medium">í•™ìƒì˜ ì†Œì¤‘í•œ í‘œí˜„ì„ ì¡´ì¤‘í•˜ë©° ê¼­ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì„¸ë°€í•˜ê²Œ ë‹¤ë“¬ìŠµë‹ˆë‹¤.</p>
        </header>

        <div class="bg-white rounded-3xl shadow-xl p-6 mb-8 border border-slate-100">
            <div class="mb-6 p-4 bg-indigo-50 rounded-xl border border-indigo-100 text-center">
                <p class="text-indigo-700 font-semibold">ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­ ì‹œìŠ¤í…œ í™œì„±í™”</p>
                <p class="text-indigo-500 text-sm mt-1">í•™ìƒì˜ ê³ ìœ í•œ í‘œí˜„ì„ ìµœëŒ€í•œ ìœ ì§€í•˜ë©° ì—ì„¸ì´ì˜ ë…¼ë¦¬ êµ¬ì¡°ë¥¼ ë³´ì™„í•©ë‹ˆë‹¤.</p>
            </div>

            <div id="dropZone" class="border-3 border-dashed border-indigo-200 rounded-2xl p-12 text-center hover:border-indigo-400 hover:bg-indigo-50 transition-all cursor-pointer mb-6 group">
                <input type="file" id="fileInput" accept="image/*" class="hidden">
                <div id="uploadPrompt">
                    <div class="text-6xl mb-4 group-hover:scale-110 transition-transform">ğŸ“¸</div>
                    <p class="text-lg font-bold text-slate-700">ì—ì„¸ì´ ì‚¬ì§„ ì—…ë¡œë“œ</p>
                    <p class="text-sm text-slate-400 mt-2">í´ë¦­í•˜ê±°ë‚˜ ì´ë¯¸ì§€ íŒŒì¼ì„ ì—¬ê¸°ë¡œ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”</p>
                </div>
                <div id="previewArea" class="hidden">
                    <img id="imagePreview" src="" class="max-h-80 mx-auto rounded-xl shadow-lg mb-4 border border-slate-200">
                    <button id="cancelBtn" class="text-red-500 font-bold hover:underline">ì‚¬ì§„ ì·¨ì†Œ ë° ë‹¤ì‹œ ì„ íƒ</button>
                </div>
            </div>

            <button id="analyzeBtn" class="w-full py-5 bg-indigo-600 text-white rounded-2xl font-bold text-xl hover:bg-indigo-700 transition-all disabled:bg-slate-300 shadow-lg shadow-indigo-100 active:scale-[0.98]" disabled>
                ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­ ì‹œì‘í•˜ê¸°
            </button>
        </div>

        <div id="loading" class="loading flex-col items-center justify-center p-10">
            <div class="animate-spin rounded-full h-14 w-14 border-b-4 border-indigo-600 mb-4"></div>
            <p class="text-indigo-600 font-bold text-lg animate-pulse">ë¦¬ì•¼ìƒ˜ AIê°€ í•™ìƒì˜ ê¸€ì„ ì†Œì¤‘íˆ ì½ê³  ìˆìŠµë‹ˆë‹¤...</p>
            <p class="text-slate-400 text-sm mt-2">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
        </div>

        <div id="resultArea" class="hidden space-y-6 fade-in">
            <div class="bg-white rounded-3xl shadow-xl p-8 border-t-8 border-indigo-500">
                <div class="flex items-center justify-between mb-6 border-b border-slate-100 pb-4">
                    <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <span>ğŸ“</span> ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­ ë³´ê³ ì„œ
                    </h2>
                    <button id="printBtn" class="px-4 py-2 bg-slate-100 text-slate-600 rounded-lg font-bold hover:bg-slate-200 transition-colors">
                        PDF ì €ì¥ / ì¸ì‡„
                    </button>
                </div>
                <div id="formattedResult" class="prose max-w-none text-slate-800 leading-relaxed text-lg"></div>
            </div>
        </div>
    </div>

    <script>
        // --- [ì„ ìƒë‹˜ì˜ API KEY ì…ë ¥] ---
        const API_KEY = "AIzaSyD26uKyQvV5plrPBBhlSRPi3pmmqZQ5upM";
        // -----------------------------

        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultArea = document.getElementById('resultArea');
        const formattedResult = document.getElementById('formattedResult');
        const loading = document.getElementById('loading');
        const printBtn = document.getElementById('printBtn');

        let base64Image = "";

        // ì¸ì‡„ ë²„íŠ¼ ì´ë²¤íŠ¸
        printBtn.onclick = () => window.print();

        // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
        dropZone.onclick = () => fileInput.click();
        fileInput.onchange = handleFile;

        function handleFile(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                base64Image = event.target.result.split(',')[1];
                document.getElementById('imagePreview').src = event.target.result;
                document.getElementById('uploadPrompt').classList.add('hidden');
                document.getElementById('previewArea').classList.remove('hidden');
                analyzeBtn.disabled = false;
                resultArea.classList.add('hidden');
            };
            reader.readAsDataURL(file);
        }

        document.getElementById('cancelBtn').onclick = (e) => {
            e.stopPropagation();
            fileInput.value = "";
            base64Image = "";
            document.getElementById('uploadPrompt').classList.remove('hidden');
            document.getElementById('previewArea').classList.add('hidden');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');
        };

        async function analyzeEssay() {
            if (!API_KEY || API_KEY.trim() === "") {
                alert("API Keyê°€ ì½”ë“œì— ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. index.html íŒŒì¼ì˜ API_KEY ë³€ìˆ˜ì— í‚¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.");
                return;
            }

            loading.classList.add('active');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');

            const systemPrompt = `ë„ˆëŠ” ì´ˆì¤‘ë“± í•™ìƒì˜ ì˜ì–´ ì—ì„¸ì´ë¥¼ ì²¨ì‚­í•´ ì£¼ëŠ” ë‹¤ì •í•œ 'ë¦¬ì•¼ìƒ˜ AI'ì•¼.
            
            [ì²¨ì‚­ ëŒ€ì›ì¹™ - ë§¤ìš° ì¤‘ìš”]
            1. í•™ìƒì˜ í‘œí˜„ ìœ ì§€: í•™ìƒì´ ì“´ ë‹¨ì–´ë‚˜ ë¬¸ì¥ í‘œí˜„ì´ ë¬¸ë²•ì ìœ¼ë¡œë‚˜ ë§¥ë½ìƒ ë¬¸ì œê°€ ì—†ë‹¤ë©´, ë” ì¢‹ì€ í‘œí˜„ìœ¼ë¡œ ë°”ê¾¸ì§€ ë§ê³  ë°˜ë“œì‹œ 'ê·¸ëŒ€ë¡œ ìœ ì§€'í•´. í•™ìƒì˜ ì›ë˜ 'ëª©ì†Œë¦¬(Voice)'ì™€ ìì‹ ê°ì„ ì§€ì¼œì£¼ëŠ” ê²ƒì´ ë„ˆì˜ ìµœìš°ì„  ì„ë¬´ì•¼.
            2. ìµœì†Œ êµì • ì›ì¹™: ëª…ë°±í•œ ë¬¸ë²•ì  ì˜¤ë¥˜(ì‹œì œ, ìˆ˜ ì¼ì¹˜, ê´€ì‚¬, ì² ì ë“±)ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ìˆ˜ì •í•´. 
            3. êµ¬ì¡° ë¶„ì„ ë° ë³´ê°•: 
               - ì„œë¡ : ë³¸ë¡  ë¬¸ë‹¨ ê°œìˆ˜ì™€ ì„œë¡ ì—ì„œ ì–¸ê¸‰í•œ ì´ìœ ì˜ ê°œìˆ˜ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸.
               - ë³¸ë¡ : ê° ë¬¸ë‹¨ì´ [ì£¼ì œ-ê·¼ê±°-ê²½í—˜] êµ¬ì¡°ì¸ì§€ í™•ì¸í•˜ê³ , ë¶€ì¡±í•œ ìš”ì†Œê°€ ìˆì„ ë•Œë§Œ í•™ìƒì˜ í˜„ì¬ ìˆ˜ì¤€ì— ë§ëŠ” ì•„ì£¼ ì‰¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì‚´ì§ ë³´ì™„í•´ì¤˜.
               - ê²°ë¡ : ë‚´ìš©ì„ ìš”ì•½í•˜ë©° ì„¤ë“ë ¥ ìˆê²Œ ë§ˆë¬´ë¦¬.
            
            [ì¶œë ¥ ë°©ì‹]
            - ìˆ˜ì • ë¶€ë¶„: ìˆ˜ì •ì´ ë°œìƒí•œ ë¬¸ì¥ë§Œ <del>ì·¨ì†Œì„ </del>ê³¼ <ins>ê°•ì¡°</ins> íƒœê·¸ë¥¼ ì‚¬ìš©í•´ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì¤˜. ìˆ˜ì •ë˜ì§€ ì•Šì€ ë¬¸ì¥ì€ ê·¸ëŒ€ë¡œ í‘œì‹œí•´.
            - ì„¤ëª…: ê° ë¬¸ë‹¨ ì•„ë˜ì— 'ğŸ’¡ ë¦¬ì•¼ìƒ˜ AIëŠ” ì™œ ì´ë ‡ê²Œ ê³ ì³¤ë‚˜ìš”?' ì„¹ì…˜ì„ ë§Œë“¤ì–´ í•œêµ­ì–´ë¡œ ì•„ì´ì˜ ëˆˆë†’ì´ì— ë§ì¶° ì•„ì£¼ ë‹¤ì •í•˜ê³  ì¹œì ˆí•˜ê²Œ ì„¤ëª…í•´ì¤˜.`;

            try {
                // ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ í™œìš©í•œ í˜¸ì¶œ ì‹œë„ (ìµœëŒ€ 5íšŒ)
                let success = false;
                let data;
                for (let i = 0; i < 5; i++) {
                    try {
                        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{
                                    parts: [
                                        { text: "ì´ ì—ì„¸ì´ë¥¼ ë¶„ì„í•´ì„œ 'ë¦¬ì•¼ìƒ˜ AI'ì˜ ì´ë¦„ìœ¼ë¡œ ì²¨ì‚­ ë³´ê³ ì„œë¥¼ HTML í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜." },
                                        { inlineData: { mimeType: "image/png", data: base64Image } }
                                    ]
                                }],
                                systemInstruction: { parts: [{ text: systemPrompt }] }
                            })
                        });
                        if (response.ok) {
                            data = await response.json();
                            success = true;
                            break;
                        }
                    } catch (e) {}
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                }

                if (!success) throw new Error("API ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í‚¤ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                
                const output = data.candidates[0].content.parts[0].text;
                formattedResult.innerHTML = output.replace(/```html|```/g, '').trim();
                resultArea.classList.remove('hidden');
                window.scrollTo({ top: resultArea.offsetTop - 40, behavior: 'smooth' });
            } catch (error) {
                alert("ë¦¬ì•¼ìƒ˜ AI ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error.message);
            } finally {
                loading.classList.remove('active');
                analyzeBtn.disabled = false;
            }
        }
        analyzeBtn.onclick = analyzeEssay;
    </script>
</body>
</html>

