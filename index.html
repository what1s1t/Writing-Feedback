<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦¬ì•¼ìƒ˜ AI ì˜ì–´ ì—ì„¸ì´ íŠœí„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; }
        .loading { display: none; }
        .loading.active { display: flex; }
        del { color: #ef4444; text-decoration: line-through; background: #fee2e2; padding: 0 2px; }
        ins { color: #2563eb; text-decoration: none; font-weight: 700; background: #dbeafe; padding: 0 4px; border-radius: 4px; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl font-bold text-indigo-600 mb-2">âœï¸ AI ì˜ì–´ ì—ì„¸ì´ ì²¨ì‚­ì†Œ</h1>
            <p class="text-slate-600 font-medium">ì‚¬ì§„ì„ ì°ì–´ ì˜¬ë¦¬ë©´ AI ì„ ìƒë‹˜ì´ ì¦‰ì‹œ ì²¨ì‚­í•˜ê³  êµ¬ì¡°ë¥¼ ì¡ì•„ì¤ë‹ˆë‹¤.</p>
        </header>

        <div class="bg-white rounded-3xl shadow-xl p-6 mb-8 border border-slate-100">
            <!-- ì•ˆë‚´ ë¬¸êµ¬ (API ì…ë ¥ì°½ ëŒ€ì‹  ë°°ì¹˜) -->
            <div class="mb-6 p-4 bg-indigo-50 rounded-xl border border-indigo-100 text-center">
                <p class="text-indigo-700 font-semibold">ë¦¬ì•¼ìƒ˜ ì „ìš© ì²¨ì‚­ ì‹œìŠ¤í…œì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <p class="text-indigo-500 text-sm mt-1">ì—ì„¸ì´ì˜ ì„œë¡ , ë³¸ë¡ (ì£¼ì œ-ê·¼ê±°-ê²½í—˜), ê²°ë¡  êµ¬ì¡°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.</p>
            </div>

            <!-- ì—…ë¡œë“œ ì˜ì—­ -->
            <div id="dropZone" class="border-3 border-dashed border-indigo-200 rounded-2xl p-12 text-center hover:border-indigo-400 hover:bg-indigo-50 transition-all cursor-pointer mb-6 group">
                <input type="file" id="fileInput" accept="image/*" class="hidden">
                <div id="uploadPrompt">
                    <div class="text-6xl mb-4 group-hover:scale-110 transition-transform">ğŸ“¸</div>
                    <p class="text-lg font-bold text-slate-700">ì—ì„¸ì´ ì‚¬ì§„ ì—…ë¡œë“œ</p>
                    <p class="text-sm text-slate-400 mt-2">í´ë¦­í•˜ê±°ë‚˜ ì´ë¯¸ì§€ íŒŒì¼ì„ ì—¬ê¸°ë¡œ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”</p>
                </div>
                <div id="previewArea" class="hidden">
                    <img id="imagePreview" src="" class="max-h-80 mx-auto rounded-xl shadow-lg mb-4 border border-slate-200">
                    <button id="cancelBtn" class="text-red-500 font-bold hover:underline">ì‚¬ì§„ ì·¨ì†Œ ë° ë‹¤ì‹œ ì„ íƒ</button>
                </div>
            </div>

            <button id="analyzeBtn" class="w-full py-5 bg-indigo-600 text-white rounded-2xl font-bold text-xl hover:bg-indigo-700 transition-all disabled:bg-slate-300 shadow-lg shadow-indigo-100 active:scale-[0.98]" disabled>
                ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­ ì‹œì‘í•˜ê¸°
            </button>
        </div>

        <!-- ë¡œë”© í‘œì‹œ -->
        <div id="loading" class="loading flex-col items-center justify-center p-10">
            <div class="animate-spin rounded-full h-14 w-14 border-b-4 border-indigo-600 mb-4"></div>
            <p class="text-indigo-600 font-bold text-lg animate-pulse">AI ì„ ìƒë‹˜ì´ ê¸€ì„ ê¼¼ê¼¼íˆ ì½ê³  ìˆìŠµë‹ˆë‹¤...</p>
            <p class="text-slate-400 text-sm mt-2">ì•½ 10~20ì´ˆ ì •ë„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
        <div id="resultArea" class="hidden space-y-6 fade-in">
            <div class="bg-white rounded-3xl shadow-xl p-8 border-t-8 border-indigo-500">
                <div class="flex items-center justify-between mb-6 border-b border-slate-100 pb-4">
                    <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <span>ğŸ“</span> ì²¨ì‚­ ê²°ê³¼ ë³´ê³ ì„œ
                    </h2>
                    <button onclick="window.print()" class="px-4 py-2 bg-slate-100 text-slate-600 rounded-lg font-bold hover:bg-slate-200 transition-colors">
                        PDF ì €ì¥ / ì¸ì‡„
                    </button>
                </div>
                <div id="formattedResult" class="prose max-w-none text-slate-800 leading-relaxed text-lg">
                    <!-- AI ê²°ê³¼ê°€ ë“¤ì–´ê°ˆ ê³³ -->
                </div>
            </div>
            
            <p class="text-center text-slate-400 text-sm pb-10">ë³¸ ì„œë¹„ìŠ¤ëŠ” Gemini 2.5 Flash ì—”ì§„ì„ ì‚¬ìš©í•˜ì—¬ ì œê³µë©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        // --- [ì¤‘ìš”] ì—¬ê¸°ì— ë³¸ì¸ì˜ API KEYë¥¼ ì…ë ¥í•˜ì„¸ìš” ---
        const API_KEY = "AIzaSyD26uKyQvV5plrPBBhlSRPi3pmmqZQ5upM";
        // ----------------------------------------------

        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultArea = document.getElementById('resultArea');
        const formattedResult = document.getElementById('formattedResult');
        const loading = document.getElementById('loading');

        let base64Image = "";

        // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
        dropZone.onclick = () => fileInput.click();
        fileInput.onchange = handleFile;

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì›
        dropZone.ondragover = (e) => { e.preventDefault(); dropZone.classList.add('bg-indigo-50'); };
        dropZone.ondragleave = () => { dropZone.classList.remove('bg-indigo-50'); };
        dropZone.ondrop = (e) => {
            e.preventDefault();
            dropZone.classList.remove('bg-indigo-50');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                fileInput.files = e.dataTransfer.files;
                handleFile({ target: { files: e.dataTransfer.files } });
            }
        };

        function handleFile(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                base64Image = event.target.result.split(',')[1];
                document.getElementById('imagePreview').src = event.target.result;
                document.getElementById('uploadPrompt').classList.add('hidden');
                document.getElementById('previewArea').classList.remove('hidden');
                analyzeBtn.disabled = false;
                resultArea.classList.add('hidden');
            };
            reader.readAsDataURL(file);
        }

        document.getElementById('cancelBtn').onclick = (e) => {
            e.stopPropagation();
            fileInput.value = "";
            base64Image = "";
            document.getElementById('uploadPrompt').classList.remove('hidden');
            document.getElementById('previewArea').classList.add('hidden');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');
        };

        async function analyzeEssay() {
            if (!API_KEY || API_KEY.includes("ì—¬ê¸°ì—")) {
                alert("API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì½”ë“œ ë‚´ë¶€ì˜ API_KEY ë³€ìˆ˜ì— í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            loading.classList.add('active');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');

            const systemPrompt = `ë„ˆëŠ” ì´ˆì¤‘ë“± ì˜ì–´ ì „ë¬¸ ì²¨ì‚­ íŠœí„°ì•¼. í•™ìƒì´ ì°ì–´ ë³´ë‚¸ ì˜ì–´ ì—ì„¸ì´ ì‚¬ì§„ì„ ë¶„ì„í•´ì„œ ì•„ë˜ ê·œì¹™ì— ë”°ë¼ ì²¨ì‚­í•´ì¤˜.
            
            1. ìˆ˜ì¤€ ìœ ì§€: ì•„ì´ì˜ ì–´íœ˜ ìˆ˜ì¤€ì„ ë„˜ì§€ ì•ŠëŠ” ì‰¬ìš´ ë‹¨ì–´ë¡œ êµì •í•´.
            2. ë‚´ìš© ë³´ì¡´: í•™ìƒì˜ ì›ë˜ ì˜ë„ë¥¼ ë°”ê¾¸ì§€ ë§ˆ.
            3. êµ¬ì¡° ë¶„ì„: 
               - ì„œë¡ : ë³¸ë¡  ë¬¸ë‹¨ ê°œìˆ˜ì™€ ì„œë¡ ì—ì„œ ì–¸ê¸‰í•œ ì´ìœ ì˜ ê°œìˆ˜ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•´.
               - ë³¸ë¡ : ê° ë¬¸ë‹¨ì´ [ì£¼ì œ-ê·¼ê±°-ê²½í—˜] êµ¬ì¡°ì¸ì§€ í™•ì¸í•˜ê³  ë¶€ì¡±í•˜ë©´ ì•„ì´ ìˆ˜ì¤€ì— ë§ê²Œ ë³´ê°•í•´.
               - ê²°ë¡ : ë‚´ìš©ì„ ìš”ì•½í•˜ë©° ì„¤ë“ë ¥ ìˆê²Œ ë§ˆë¬´ë¦¬í•´.
            4. ì‹œê°ì  í‘œì‹œ: ìˆ˜ì •ëœ ë¶€ë¶„ì€ HTML íƒœê·¸ë¥¼ ì‚¬ìš©í•´. í‹€ë¦° ë¶€ë¶„ì€ <del>ì·¨ì†Œì„ </del>ìœ¼ë¡œ, ìˆ˜ì •ë³¸ì€ <ins>ê°•ì¡°</ins>ë¡œ í‘œì‹œí•´. 
            5. í•œêµ­ì–´ ì„¤ëª…: ê° ë¬¸ë‹¨ë§ˆë‹¤ 'ğŸ’¡ ì™œ ì´ë ‡ê²Œ ê³ ì³¤ë‚˜ìš”?'ë¼ëŠ” ì„¹ì…˜ì„ ë§Œë“¤ì–´ ì•„ì£¼ ì¹œì ˆí•˜ê²Œ í•œêµ­ì–´ë¡œ ì„¤ëª…í•´ì¤˜.`;

            const payload = {
                contents: [{
                    parts: [
                        { text: "ì´ ì—ì„¸ì´ë¥¼ ë¶„ì„í•´ì„œ ì²¨ì‚­ ë³´ê³ ì„œë¥¼ HTML í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜." },
                        { inlineData: { mimeType: "image/png", data: base64Image } }
                    ]
                }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            try {
                let response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('API í˜¸ì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');

                const result = await response.json();
                const text = result.candidates[0].content.parts[0].text;
                
                // ë§ˆí¬ë‹¤ìš´ ë°±í‹± ì œê±° ë° ê²°ê³¼ í‘œì‹œ
                formattedResult.innerHTML = text.replace(/```html|```/g, '').trim();
                resultArea.classList.remove('hidden');
                
                // ê²°ê³¼ ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                window.scrollTo({ top: resultArea.offsetTop - 40, behavior: 'smooth' });

            } catch (error) {
                console.error(error);
                alert("ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. API Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.");
            } finally {
                loading.classList.remove('active');
                analyzeBtn.disabled = false;
            }
        }

        analyzeBtn.onclick = analyzeEssay;
    </script>
</body>
</html>

