<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; }
        .loading { display: none; }
        .loading.active { display: flex; }
        
        /* 9ë²ˆ ì§€ì¹¨: ì²¨ì‚­ì€ ë¶‰ì€ ê¸€ì”¨ë¡œ í‘œì‹œ */
        del { color: #94a3b8; text-decoration: line-through; background: #f1f5f9; padding: 0 2px; }
        ins { color: #ef4444; text-decoration: none; font-weight: 700; background: #fee2e2; padding: 0 4px; border-radius: 4px; }
        
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @media print {
            .no-print { display: none; }
            body { background-color: white; padding: 0; }
            .print-area { box-shadow: none; border: none; width: 100%; max-width: none; }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10 no-print">
            <h1 class="text-3xl font-bold text-indigo-600 mb-2">âœï¸ ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­</h1>
            <p class="text-slate-600 font-medium">í•™ìƒì˜ ê¸€ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë©°, ë…¼ë¦¬ì ì¸ ì—ì„¸ì´ ì‘ì„±ì„ ë•ëŠ” 1:1 íŠœí„°ì…ë‹ˆë‹¤.</p>
        </header>

        <div class="bg-white rounded-3xl shadow-xl p-6 mb-8 border border-slate-100 no-print">
            <div class="mb-6 p-4 bg-indigo-50 rounded-xl border border-indigo-100 text-center">
                <p class="text-indigo-700 font-semibold">ë¦¬ì•¼ìƒ˜ AI íŠœí„°ë§ ëª¨ë“œ í™œì„±í™”</p>
                <p class="text-indigo-500 text-sm mt-1">ì„œë¡ ì˜ ì´ìœ  ì–¸ê¸‰ê³¼ ë³¸ë¡ ì˜ êµ¬ì¡°(ì´ìœ -ì„¤ëª…-ê²½í—˜)ë¥¼ ì§‘ì¤‘ ì ê²€í•©ë‹ˆë‹¤.</p>
            </div>

            <div id="dropZone" class="border-3 border-dashed border-indigo-200 rounded-2xl p-12 text-center hover:border-indigo-400 hover:bg-indigo-50 transition-all cursor-pointer mb-6 group">
                <input type="file" id="fileInput" accept="image/*" class="hidden">
                <div id="uploadPrompt">
                    <div class="text-6xl mb-4 group-hover:scale-110 transition-transform">ğŸ“¸</div>
                    <p class="text-lg font-bold text-slate-700">ì—ì„¸ì´ ì‚¬ì§„ ì—…ë¡œë“œ</p>
                    <p class="text-sm text-slate-400 mt-2">ì‚¬ì§„ì„ ì°ì–´ ì˜¬ë¦¬ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</p>
                </div>
                <div id="previewArea" class="hidden">
                    <img id="imagePreview" src="" class="max-h-80 mx-auto rounded-xl shadow-lg mb-4 border border-slate-200">
                    <button id="cancelBtn" class="text-red-500 font-bold hover:underline">ì‚¬ì§„ ë‹¤ì‹œ ì„ íƒ</button>
                </div>
            </div>

            <button id="analyzeBtn" class="w-full py-5 bg-indigo-600 text-white rounded-2xl font-bold text-xl hover:bg-indigo-700 transition-all disabled:bg-slate-300 shadow-lg shadow-indigo-100 active:scale-[0.98]" disabled>
                ë¦¬ì•¼ìƒ˜ AIì—ê²Œ ì²¨ì‚­ ë°›ê¸°
            </button>
        </div>

        <div id="loading" class="loading flex-col items-center justify-center p-10 no-print">
            <div class="animate-spin rounded-full h-14 w-14 border-b-4 border-indigo-600 mb-4"></div>
            <p class="text-indigo-600 font-bold text-lg animate-pulse">ë¦¬ì•¼ìƒ˜ AIê°€ ê¸€ì˜ êµ¬ì¡°ì™€ í‘œí˜„ì„ ê¼¼ê¼¼íˆ ë³´ê³  ìˆì–´ìš”...</p>
            <p class="text-slate-400 text-sm mt-2">ë…¼ë¦¬ì ì¸ ì—ì„¸ì´ë¥¼ ìœ„í•´ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤!</p>
        </div>

        <div id="resultArea" class="hidden space-y-6 fade-in print-area">
            <div class="bg-white rounded-3xl shadow-xl p-8 border-t-8 border-indigo-500">
                <div class="flex items-center justify-between mb-6 border-b border-slate-100 pb-4 no-print">
                    <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <span>ğŸ“</span> ë¦¬ì•¼ìƒ˜ AI ì²¨ì‚­ ê²°ê³¼
                    </h2>
                    <button id="printBtn" class="px-4 py-2 bg-slate-100 text-slate-600 rounded-lg font-bold hover:bg-slate-200 transition-colors">
                        PDF ì €ì¥ / ì¸ì‡„
                    </button>
                </div>
                <div id="formattedResult" class="prose max-w-none text-slate-800 leading-relaxed text-lg"></div>
            </div>
        </div>
    </div>

    <script>
        // ì„ ìƒë‹˜ì˜ API í‚¤
        const API_KEY = "AIzaSyD26uKyQvV5plrPBBhlSRPi3pmmqZQ5upM"; 
        // ì„±ê³µë¥ ì„ ë†’ì´ê¸° ìœ„í•´ ê°€ì¥ ì•ˆì •ì ì¸ gemini-1.5-flash ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
        const MODEL_NAME = "gemini-1.5-flash";

        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultArea = document.getElementById('resultArea');
        const formattedResult = document.getElementById('formattedResult');
        const loading = document.getElementById('loading');
        const printBtn = document.getElementById('printBtn');

        let base64Image = "";

        printBtn.onclick = () => window.print();
        dropZone.onclick = () => fileInput.click();
        fileInput.onchange = handleFile;

        function handleFile(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                base64Image = event.target.result.split(',')[1];
                document.getElementById('imagePreview').src = event.target.result;
                document.getElementById('uploadPrompt').classList.add('hidden');
                document.getElementById('previewArea').classList.remove('hidden');
                analyzeBtn.disabled = false;
                resultArea.classList.add('hidden');
            };
            reader.readAsDataURL(file);
        }

        document.getElementById('cancelBtn').onclick = (e) => {
            e.stopPropagation();
            fileInput.value = "";
            base64Image = "";
            document.getElementById('uploadPrompt').classList.remove('hidden');
            document.getElementById('previewArea').classList.add('hidden');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');
        };

        async function analyzeEssay() {
            loading.classList.add('active');
            analyzeBtn.disabled = true;
            resultArea.classList.add('hidden');

            const systemPrompt = `ë„ˆì˜ ì´ë¦„ì€ 'ë¦¬ì•¼ìƒ˜ AI'ì´ê³ , í•™ìƒë“¤ì˜ ì˜ì–´ ì—ì„¸ì´ ì‘ì„±ì„ ë„ì™€ì£¼ëŠ” ì „ë¬¸ íŠœí„°ì•¼.
            ì•„ë˜ ì§€ì¹¨ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•˜ì—¬ í•™ìƒì˜ ê¸€ì„ ì²¨ì‚­í•´ì¤˜.

            [ì²¨ì‚­ í•µì‹¬ ì§€ì¹¨]
            1. í•™ìƒ ìˆ˜ì¤€ ë§ì¶¤í˜• ìˆ˜ì •: í•™ìƒì˜ ì›ë˜ ë‹¨ì–´, í†¤, ìŠ¤íƒ€ì¼ì„ ìµœëŒ€í•œ ìœ ì§€í•´. ë¬¸ë²•ì´ë‚˜ í‘œí˜„ì´ ìì—°ìŠ¤ëŸ½ì§€ ì•Šì„ ë•Œë§Œ í•™ìƒì˜ ìˆ˜ì¤€ì— ë§ì¶°ì„œ ì‰¬ìš´ ë‹¨ì–´ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ì •í•´ì¤˜.
            2. êµ¬ì¡° í™•ì¸: 
               - ì²« ë¬¸ë‹¨ì€ ë°˜ë“œì‹œ ì„œë¡ (Introduction), ë§ˆì§€ë§‰ ë¬¸ë‹¨ì€ ê²°ë¡ (Conclusion)ì´ì–´ì•¼ í•´.
               - ë³¸ë¬¸(Body)ì˜ ê° ë¬¸ë‹¨ì€ ë°˜ë“œì‹œ [ì´ìœ (Reason) - ì„¤ëª…(Explanation) - ê²½í—˜/ì˜ˆì‹œ(Experience/Example)]ì˜ êµ¬ì¡°ë¥¼ ê°–ì¶°ì•¼ í•´.
            3. ì„œë¡ -ë³¸ë¬¸ ì¼ì¹˜ (ë§¤ìš° ì¤‘ìš”): ì„œë¡ ì—ëŠ” ë³¸ë¬¸ì˜ ê° ë¬¸ë‹¨ì—ì„œ ë‹¤ë£° ì´ìœ ë“¤ì´ ëª¨ë‘ ì–¸ê¸‰ë˜ì–´ì•¼ í•´. 
               - ì˜ˆ: ë³¸ë¬¸ì´ 3ê°œ ë¬¸ë‹¨ì´ë©´ ì„œë¡ ì— 3ê°œì˜ ì´ìœ ê°€ ë‹¤ ë‚˜ì™€ì•¼ í•¨.
               - ë§Œì•½ ë³¸ë¬¸ ê°œìˆ˜ì™€ ì„œë¡ ì˜ ì´ìœ  ê°œìˆ˜ê°€ ë§ì§€ ì•Šìœ¼ë©´, ë³¸ë¬¸ì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì„œë¡ ì— ì´ìœ ë¥¼ ì¶”ê°€í•´ì„œ ê³ ì³ì£¼ê±°ë‚˜ ë‹¤ì •í•˜ê²Œ ì§€ì í•´ì¤˜.
            4. ì‹œê°ì  ì²¨ì‚­: ìˆ˜ì •ì´ í•„ìš”í•œ ë¶€ë¶„ì€ ë°˜ë“œì‹œ <del>ê¸°ì¡´ ë¬¸ì¥</del> <ins>ìˆ˜ì •ëœ ë¬¸ì¥</ins> íƒœê·¸ë¥¼ ì‚¬ìš©í•´. (ins íƒœê·¸ ì•ˆì˜ ê¸€ì”¨ëŠ” ë¶‰ì€ìƒ‰ìœ¼ë¡œ ë³´ì¼ ê±°ì•¼).
            5. ì´ìœ  ì„¤ëª…: ì™œ ê·¸ë ‡ê²Œ ê³ ì³¤ëŠ”ì§€ 'ğŸ’¡ ë¦¬ì•¼ìƒ˜ AIì˜ ê¿€íŒ' ì„¹ì…˜ì„ ë§Œë“¤ì–´ ì•„ì£¼ ì‰½ê²Œ ì„¤ëª…í•´ì¤˜.
            6. ë§íˆ¬: ì‰½ê³  ê²©ë ¤í•˜ëŠ” ì–´ì¡°ë¥¼ ì‚¬ìš©í•´. (ì˜ˆ: "ì •ë§ ì˜ ì¼ì–´!", "ì¡°ê¸ˆë§Œ ë‹¤ë“¬ìœ¼ë©´ ì™„ë²½í•´!")

            [ì¶œë ¥ ê²°ê³¼ ì–‘ì‹]
            - ê²°ê³¼ëŠ” HTML í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.
            - ê° ì„¹ì…˜ë§ˆë‹¤ ë‹¤ì •í•œ í”¼ë“œë°±ì„ í¬í•¨í•´ì¤˜.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [
                                { text: "ì´ ì—ì„¸ì´ë¥¼ ë¶„ì„í•´ì„œ 'ë¦¬ì•¼ìƒ˜ AI'ë¡œì„œ ì²¨ì‚­ ë³´ê³ ì„œë¥¼ HTML í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜." },
                                { inlineData: { mimeType: "image/png", data: base64Image } }
                            ]
                        }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || "API ìš”ì²­ ì‹¤íŒ¨");
                }

                const data = await response.json();
                const output = data.candidates[0]?.content?.parts[0]?.text;
                
                if (!output) throw new Error("ë¶„ì„ ê²°ê³¼ë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");

                formattedResult.innerHTML = output.replace(/```html|```/g, '').trim();
                resultArea.classList.remove('hidden');
                window.scrollTo({ top: resultArea.offsetTop - 40, behavior: 'smooth' });
            } catch (error) {
                console.error("Error details:", error);
                alert("ë¦¬ì•¼ìƒ˜ AI ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error.message + "\n(API í‚¤ê°€ í™œì„±í™”ë  ë•Œê¹Œì§€ ì ì‹œ ê¸°ë‹¤ë ¤ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)");
            } finally {
                loading.classList.remove('active');
                analyzeBtn.disabled = false;
            }
        }
        analyzeBtn.onclick = analyzeEssay;
    </script>
</body>
</html>

